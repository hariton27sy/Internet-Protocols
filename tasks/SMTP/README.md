# SMTP Client
SMTP клиент который отправляе все изображения из указанной директории

# Usage
Вся информация в справке
> python index.py -h

# Как внутри
Все очень сложно и запутанно. Так как нужно отправить лишь один раз писмо то алгоритм линеен:
* На первом этапе происходит сбор всех изображений из папки и кодируется в тело сообщения
* Происходит подключение к серверу:
    * Если указан ключ `ssl` то сначала клиент пытаеся подключиться через `ssl` соединение. Если не удается, то работает в обычном режиме
    * Отправляет `EHLO` запрос
    * Небольшой парсинг данных - попытка достать возможноть `PIPELINING` и максимальный размер одного изображения, также возможность `STARTTLS`
    * Если сервер поддерживает `STARTTLS` и необходимо соединение через ssl, то устанавливаетсся защищенное соединение
    * Формирование письма
        * Если размер письма больше максимального размера, то происходит разделение письма на более мелкие с использованием типа `message/partial`
        * Все полученные письма отправляются на сервер

# Проблемы
* Сервер может отказать на любом из этапов в отправке, и в коде могут быть обработаны не все случаи обрыва соединения. 
* Также проблема в том, что необходим парсинг данных, а разные сервера могут отправлять одни и те же данные по-разному:
    * Для гугла код ответа это не просто три цифры, но и указание еще какой-то цифры), и через пробел текстовое описание
    * Для яндекса кодответа дефис, Текстоковое описание
    ...
* Еще одна проблема возникает при тестировании, серверы ругаются на спам

# Outro
Скрипт написан в учебных целях по курсу `Протоколы интернет`

> Матмех, УрФУ, 2020